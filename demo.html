<div class="demo">
  <button id="install-btn" style="display: none">Add to "Page Capture" Extension Chrome</button>

  <div id="interacive-demo" style="display: none">

    <div id="box1">
      <h3>Title Box 1</h3>
      <img src="./logo.png">
      <p style="color: red;">
        This will be in the page capture...
      </p>
    </div>

    <div id="options">
      <table>
        <tr>
          <th colspan="2">Api Example</th>
        </tr>
        <tr>
          <td>getVersion</td>
          <td><button id="get_version">run</button></td>
        </tr>
        <tr>
          <td>capturePage</td>
          <td><button id="pc_page">run</button></td>
        </tr>
        <tr>
          <td class="api">captureElement</td>
          <td>
            <div class="params">
              elementId: <input type="text" id="elementId" value="#box1" style="width: 130px"><br>
              <button id="pc_box1">run</button>
            </div>
          </td>
        </tr>
        <tr>
          <td class="api">captureUrl</td>
          <td>
            <div class="params">
              url: <input type="text" id="url" placeholder="http://"><br>
              <button id="pc_url">run</button>
            </div>
          </td>
        </tr>
        <tr>
          <td class="api">captureUrlWithOverlay</td>
          <td>
            <div class="params">
              url: <input type="text" id="url2" placeholder="http://" value=""><br>
              imgUrl: <input type="text" id="overlay_image" placeholder="http://optional.image.url" value=""><br>
              includeOverlay: <input type="checkbox" checked id="include_overlay"><br>
              <button id="pc_url2">run</button>
            </div>
          </td>
        </tr>
        <tr>
          <td class="api">captureSection</td>
          <td>
            <div class="params">
              x: <input type="number" id="section_x" value="10"><br>
              y: <input type="number" id="section_y" value="10"><br>
              width: <input type="number" id="section_w" value="300"><br>
              height: <input type="number" id="section_h" value="250"><br>
              <button id="pc_section">run</button>
            </div>
          </td>
        </tr>
        <tr>
          <td class="api">captureImage</td>
          <td>
            <div class="params">
              url: <input type="text" id="image_url" placeholder="http://"><br>
              width: <input type="number" id="img_w" value="300"><br>
              height: <input type="number" id="img_h" value="250"><br>
              <button id="pc_image">run</button>
            </div>
          </td>
        </tr>
      </table>

    </div>

    <br style="clear: both">
    <h4>&#8650; RESULT &#8650;</h4>
    <div id="result"></div>

    <script type="text/javascript">
      var pcQueue = pcQueue || [];

      pcQueue.push(function() {

        $('#get_version').on('click', function() {
          PageCapture.getVersion(function(v) {
            $('#result').html('version = ' + v);
          });
        });

        $('#pc_box1').on('click', function() {
          var selector = $('#elementId').val();
          PageCapture.captureElement(selector, function(img) {
            $('#result').html('<img src="' + img + '">');
          });
        });

        $('#pc_page').on('click', function() {
          PageCapture.capturePage(function(img) {
            $('#result').html('<img src="' + img + '">');
          });
        });

        $('#pc_section').on('click', function() {
          var x = $('#section_x').val();
          var y = $('#section_y').val();
          var width = $('#section_w').val();
          var height = $('#section_h').val();
          PageCapture.captureSection(x, y, width, height, function(img) {
            $('#result').html('<img src="' + img + '">');
          });
        });

        $('#pc_image').on('click', function() {
          var url = $('#image_url').val();
          var width = $('#img_w').val();
          var height = $('#img_h').val();
          PageCapture.captureImage(url, width, height, function(img) {
            $('#result').html('<img src="' + img + '">');
          });
        });

        $('#pc_url').on('click', function() {
          var url = $('#url').val();
          PageCapture.captureUrl(url, function(img) {
            $('#result').html('<img src="' + img + '">');
          });
        });

        $('#pc_url2').on('click', function() {
          var url = $('#url2').val();
          var overlay = $('#overlay_image').val();
          var includeOverlay = $('#include_overlay').is(':checked');
          console.log('includeOverlay', includeOverlay);
          PageCapture.captureUrlWithOverlay(url, overlay, includeOverlay, function(data) {
            var overlayInfo = 'Raw Response <pre>' + JSON.stringify(data, null, 2) + '</pre>';
            $('#result').html(overlayInfo + '<img src="' + data.img + '">');
          });
        });

      });

    </script>
  </div>

  <script>
    (function() {
      if (typeof chrome === 'undefined') {
        $('#content .demo').html('<h1>This demo page will only work in chrome.</h1>');
      } else {
        $('#install-btn').on('click', function() {
          chrome.webstore.install('https://chrome.google.com/webstore/detail/jalljeamdfcpcigocpbgfbebdjfmpdof',
            function() {
              console.log("Sucess", arguments);
              location.reload();
            },
            function() {
              console.log("Failure:", arguments);
            });
        });

        $('.demo .api').on('click', function(){
          $('.demo .params').hide();
          $(this).parents('tr').find('.params').show();
        });

        setTimeout(function() {
          if (chrome.app && typeof PageCapture === 'undefined') {
            $('#install-btn').show();
          } else {
            $('#interacive-demo').show();
          }
        }, 500);
      }
    })();
  </script>
</div>